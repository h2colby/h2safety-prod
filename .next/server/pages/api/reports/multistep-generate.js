"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/reports/multistep-generate";
exports.ids = ["pages/api/reports/multistep-generate"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "firebase-admin/app":
/*!*************************************!*\
  !*** external "firebase-admin/app" ***!
  \*************************************/
/***/ ((module) => {

module.exports = import("firebase-admin/app");;

/***/ }),

/***/ "firebase-admin/firestore":
/*!*******************************************!*\
  !*** external "firebase-admin/firestore" ***!
  \*******************************************/
/***/ ((module) => {

module.exports = import("firebase-admin/firestore");;

/***/ }),

/***/ "openai":
/*!*************************!*\
  !*** external "openai" ***!
  \*************************/
/***/ ((module) => {

module.exports = import("openai");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Freports%2Fmultistep-generate&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Freports%2Fmultistep-generate.ts&middlewareConfigBase64=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Freports%2Fmultistep-generate&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Freports%2Fmultistep-generate.ts&middlewareConfigBase64=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_reports_multistep_generate_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/reports/multistep-generate.ts */ \"(api)/./pages/api/reports/multistep-generate.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_reports_multistep_generate_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_reports_multistep_generate_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_reports_multistep_generate_ts__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_reports_multistep_generate_ts__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/reports/multistep-generate\",\n        pathname: \"/api/reports/multistep-generate\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _pages_api_reports_multistep_generate_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnJlcG9ydHMlMkZtdWx0aXN0ZXAtZ2VuZXJhdGUmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyUyRmFwaSUyRnJlcG9ydHMlMkZtdWx0aXN0ZXAtZ2VuZXJhdGUudHMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQStGO0FBQ3ZDO0FBQ0U7QUFDMUQ7QUFDc0U7QUFDdEU7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLHFFQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyxxRUFBUTtBQUNwQztBQUNPLHdCQUF3Qix5R0FBbUI7QUFDbEQ7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQscUMiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzL2FwaS9yZXBvcnRzL211bHRpc3RlcC1nZW5lcmF0ZS50c1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCAnZGVmYXVsdCcpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgJ2NvbmZpZycpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvcmVwb3J0cy9tdWx0aXN0ZXAtZ2VuZXJhdGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9yZXBvcnRzL211bHRpc3RlcC1nZW5lcmF0ZVwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6ICcnLFxuICAgICAgICBmaWxlbmFtZTogJydcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Freports%2Fmultistep-generate&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Freports%2Fmultistep-generate.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/reports/multistep-generate.ts":
/*!*************************************************!*\
  !*** ./pages/api/reports/multistep-generate.ts ***!
  \*************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var firebase_admin_app__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! firebase-admin/app */ \"firebase-admin/app\");\n/* harmony import */ var firebase_admin_firestore__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! firebase-admin/firestore */ \"firebase-admin/firestore\");\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! openai */ \"openai\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([firebase_admin_app__WEBPACK_IMPORTED_MODULE_0__, firebase_admin_firestore__WEBPACK_IMPORTED_MODULE_1__, openai__WEBPACK_IMPORTED_MODULE_2__]);\n([firebase_admin_app__WEBPACK_IMPORTED_MODULE_0__, firebase_admin_firestore__WEBPACK_IMPORTED_MODULE_1__, openai__WEBPACK_IMPORTED_MODULE_2__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n// pages/api/reports/multistep-generate.ts\n\n\n\n// Validate environment variables\nif (!process.env.FIREBASE_SERVICE_ACCOUNT_KEY_BASE64) {\n    throw new Error('FIREBASE_SERVICE_ACCOUNT_KEY_BASE64 is not set');\n}\nif (!process.env.OPENAI_API_KEY) {\n    throw new Error('OPENAI_API_KEY is not set');\n}\n// Decode and parse the base64-encoded Firebase service account JSON\nconst base64 = process.env.FIREBASE_SERVICE_ACCOUNT_KEY_BASE64;\nconst jsonString = Buffer.from(base64, 'base64').toString('utf-8');\nconst serviceAccount = JSON.parse(jsonString);\n// Initialize Firebase Admin SDK if not already initialized\nif (!(0,firebase_admin_app__WEBPACK_IMPORTED_MODULE_0__.getApps)().length) {\n    (0,firebase_admin_app__WEBPACK_IMPORTED_MODULE_0__.initializeApp)({\n        credential: (0,firebase_admin_app__WEBPACK_IMPORTED_MODULE_0__.cert)(serviceAccount)\n    });\n}\nconst adminDb = (0,firebase_admin_firestore__WEBPACK_IMPORTED_MODULE_1__.getFirestore)();\nconst openai = new openai__WEBPACK_IMPORTED_MODULE_2__.OpenAI({\n    apiKey: process.env.OPENAI_API_KEY\n});\nasync function handler(req, res) {\n    const { projectId, threadId } = req.body;\n    // Validate request body\n    if (typeof projectId !== 'string' || typeof threadId !== 'string') {\n        return res.status(400).json({\n            error: 'Missing or invalid projectId/threadId'\n        });\n    }\n    try {\n        // Fetch project data\n        const projectRef = adminDb.doc(`projects/${projectId}`);\n        const projectSnap = await projectRef.get();\n        if (!projectSnap.exists) {\n            return res.status(404).json({\n                error: 'Project not found'\n            });\n        }\n        const projectData = projectSnap.data();\n        const userId = projectData.ownerId || null;\n        // Fetch thread data\n        const threadRef = adminDb.doc(`threads/${threadId}`);\n        const threadSnap = await threadRef.get();\n        if (!threadSnap.exists) {\n            return res.status(404).json({\n                error: 'Thread not found'\n            });\n        }\n        const threadData = threadSnap.data();\n        const messages = threadData.messages || [];\n        // Convert messages to OpenAI-compatible conversation format\n        const allMessages = messages.map((m)=>({\n                role: m.sender === 'ai' ? 'assistant' : 'user',\n                content: m.content\n            }));\n        const conversationText = allMessages.map((m)=>`${m.role === 'assistant' ? 'AI:' : 'User:'} ${m.content}`).join('\\n\\n');\n        // ---------------------------------------------\n        // Step 1: Determine Relevant Sections\n        // ---------------------------------------------\n        const sectionPrompt = `\nBased on the following project details and conversation, identify the most relevant sections to include in a detailed engineering report. For each section, provide a short description of its purpose and what content it should include. Exclude irrelevant sections.\n\n**General Categories**:\n1. Engineering Codes and Standards\n2. Safety and Risk Assessment\n3. Environmental Compliance and Permitting\n4. Technical Process Analysis\n5. Project Management Recommendations\n6. References and Citations (all codes, standards, and regulations mentioned)\n7. Other Relevant Topics (if applicable)\n\n**Inputs**:\n- Project Details: ${JSON.stringify(projectData, null, 2)}\n- Thread Conversation:\n${conversationText}\n\n**Output Format**:\nProvide a structured list of relevant sections with descriptions.\n    `;\n        const sectionResponse = await openai.chat.completions.create({\n            model: 'gpt-4o-mini',\n            messages: [\n                {\n                    role: 'system',\n                    content: 'You are a professional technical writer specializing in hydrogen engineering and safety.'\n                },\n                {\n                    role: 'user',\n                    content: sectionPrompt\n                }\n            ],\n            temperature: 0.3,\n            top_p: 0.85,\n            frequency_penalty: 0.2,\n            presence_penalty: 0.2,\n            max_tokens: 2000\n        });\n        const relevantSections = sectionResponse.choices[0]?.message?.content || '';\n        console.log('Relevant Sections:', relevantSections);\n        // ---------------------------------------------\n        // Step 2: Draft a Detailed Report\n        // ---------------------------------------------\n        const draftReportPrompt = `\nYou are an expert technical report writer. Using the relevant sections identified below, draft a detailed, multipage report. Each section must be comprehensive, include all key information from the conversation and project details, and maintain a formal tone.\n\n**Relevant Sections**:\n${relevantSections}\n\n**Project Details**:  \n${JSON.stringify(projectData, null, 2)}\n\n**Thread Conversation**:  \n${conversationText}\n\n### Report Requirements:\n- Include all relevant sections identified.\n- Provide in-depth analysis, citations, and actionable recommendations.\n- Use structured formatting: sections, headers, bullet points, and tables where applicable.\n- Focus on thoroughness and detail. Ensure no insights from the conversation are omitted.\n\nGenerate the detailed report.\n    `;\n        const draftResponse = await openai.chat.completions.create({\n            model: 'gpt-4o-mini',\n            messages: [\n                {\n                    role: 'system',\n                    content: 'You are a professional technical writer specializing in hydrogen engineering reports.'\n                },\n                {\n                    role: 'user',\n                    content: draftReportPrompt\n                }\n            ],\n            temperature: 0.2,\n            max_tokens: 6000\n        });\n        const draftReport = draftResponse.choices[0]?.message?.content || '';\n        console.log('Draft Report:', draftReport);\n        // ---------------------------------------------\n        // Step 3: Extract References\n        // ---------------------------------------------\n        const referencesPrompt = `\nFrom the following draft report, extract and compile a comprehensive list of all mentioned codes, standards, rules, regulations, and other referenced bodies of work. Each item should include its full name and, if possible, a brief description of its relevance to the project.\n\n**Draft Report**:\n${draftReport}\n\nProvide the extracted references in a structured list format.\n    `;\n        const referencesResponse = await openai.chat.completions.create({\n            model: 'gpt-4o-mini',\n            messages: [\n                {\n                    role: 'system',\n                    content: 'You are a technical documentation specialist.'\n                },\n                {\n                    role: 'user',\n                    content: referencesPrompt\n                }\n            ],\n            temperature: 0.2,\n            max_tokens: 2000\n        });\n        const referencesSection = referencesResponse.choices[0]?.message?.content || '';\n        console.log('References Section:', referencesSection);\n        // ---------------------------------------------\n        // Step 4: Refine the Entire Report\n        // ---------------------------------------------\n        const refinePrompt = `\nYou are an expert editor. Refine the draft report below to ensure it is polished, thorough, and professional. Expand any underdeveloped sections, and integrate the references section as a formal part of the report.\n\n**Draft Report**:\n${draftReport}\n\n**References Section**:\n${referencesSection}\n\nRefine and enhance the report, ensuring all insights and references are included.\n    `;\n        const refineResponse = await openai.chat.completions.create({\n            model: 'gpt-4o-mini',\n            messages: [\n                {\n                    role: 'system',\n                    content: 'You are a professional editor.'\n                },\n                {\n                    role: 'user',\n                    content: refinePrompt\n                }\n            ],\n            temperature: 0.2,\n            max_tokens: 6000\n        });\n        const finalReportContent = refineResponse.choices[0]?.message?.content || '';\n        // Save the final report to Firestore\n        const reportRef = adminDb.collection('reports').doc();\n        await reportRef.set({\n            projectId,\n            userId,\n            title: `Engineering Report - ${projectData?.projectName || 'Project'}`,\n            content: finalReportContent,\n            type: 'project',\n            createdAt: new Date()\n        });\n        return res.status(200).json({\n            message: 'Report generated',\n            content: finalReportContent\n        });\n    } catch (error) {\n        console.error('Error generating report:', error);\n        return res.status(500).json({\n            error: error.message\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvcmVwb3J0cy9tdWx0aXN0ZXAtZ2VuZXJhdGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBLDBDQUEwQztBQUV3QjtBQUNWO0FBQ3hCO0FBRWhDLGlDQUFpQztBQUNqQyxJQUFJLENBQUNLLFFBQVFDLEdBQUcsQ0FBQ0MsbUNBQW1DLEVBQUU7SUFDcEQsTUFBTSxJQUFJQyxNQUFNO0FBQ2xCO0FBQ0EsSUFBSSxDQUFDSCxRQUFRQyxHQUFHLENBQUNHLGNBQWMsRUFBRTtJQUMvQixNQUFNLElBQUlELE1BQU07QUFDbEI7QUFFQSxvRUFBb0U7QUFDcEUsTUFBTUUsU0FBU0wsUUFBUUMsR0FBRyxDQUFDQyxtQ0FBbUM7QUFDOUQsTUFBTUksYUFBYUMsT0FBT0MsSUFBSSxDQUFDSCxRQUFRLFVBQVVJLFFBQVEsQ0FBQztBQUMxRCxNQUFNQyxpQkFBaUJDLEtBQUtDLEtBQUssQ0FBQ047QUFFbEMsMkRBQTJEO0FBQzNELElBQUksQ0FBQ1gsMkRBQU9BLEdBQUdrQixNQUFNLEVBQUU7SUFDckJqQixpRUFBYUEsQ0FBQztRQUNaa0IsWUFBWWpCLHdEQUFJQSxDQUFDYTtJQUNuQjtBQUNGO0FBRUEsTUFBTUssVUFBVWpCLHNFQUFZQTtBQUM1QixNQUFNa0IsU0FBUyxJQUFJakIsMENBQU1BLENBQUM7SUFBRWtCLFFBQVFqQixRQUFRQyxHQUFHLENBQUNHLGNBQWM7QUFBQztBQUVoRCxlQUFlYyxRQUM1QkMsR0FBbUIsRUFDbkJDLEdBQW9CO0lBRXBCLE1BQU0sRUFBRUMsU0FBUyxFQUFFQyxRQUFRLEVBQUUsR0FBR0gsSUFBSUksSUFBSTtJQUV4Qyx3QkFBd0I7SUFDeEIsSUFBSSxPQUFPRixjQUFjLFlBQVksT0FBT0MsYUFBYSxVQUFVO1FBQ2pFLE9BQU9GLElBQ0pJLE1BQU0sQ0FBQyxLQUNQQyxJQUFJLENBQUM7WUFBRUMsT0FBTztRQUF3QztJQUMzRDtJQUVBLElBQUk7UUFDRixxQkFBcUI7UUFDckIsTUFBTUMsYUFBYVosUUFB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U0FBUztZQUFvQmpCLFNBQVM0QjtRQUFtQjtJQUNyRSxFQUFFLE9BQU8vQyxPQUFZO1FBQ25CcUMsUUFBUXJDLEtBQUssQ0FBQyw0QkFBNEJBO1FBQzFDLE9BQU9OLElBQUlJLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsT0FBT0EsTUFBTW9DLE9BQU87UUFBQztJQUNyRDtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvdG9iZS9IMlNhZmV0eURldi9oMnNhZmV0eS1haS9wYWdlcy9hcGkvcmVwb3J0cy9tdWx0aXN0ZXAtZ2VuZXJhdGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gcGFnZXMvYXBpL3JlcG9ydHMvbXVsdGlzdGVwLWdlbmVyYXRlLnRzXG5pbXBvcnQgdHlwZSB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcbmltcG9ydCB7IGdldEFwcHMsIGluaXRpYWxpemVBcHAsIGNlcnQgfSBmcm9tICdmaXJlYmFzZS1hZG1pbi9hcHAnO1xuaW1wb3J0IHsgZ2V0RmlyZXN0b3JlIH0gZnJvbSAnZmlyZWJhc2UtYWRtaW4vZmlyZXN0b3JlJztcbmltcG9ydCB7IE9wZW5BSSB9IGZyb20gJ29wZW5haSc7XG5cbi8vIFZhbGlkYXRlIGVudmlyb25tZW50IHZhcmlhYmxlc1xuaWYgKCFwcm9jZXNzLmVudi5GSVJFQkFTRV9TRVJWSUNFX0FDQ09VTlRfS0VZX0JBU0U2NCkge1xuICB0aHJvdyBuZXcgRXJyb3IoJ0ZJUkVCQVNFX1NFUlZJQ0VfQUNDT1VOVF9LRVlfQkFTRTY0IGlzIG5vdCBzZXQnKTtcbn1cbmlmICghcHJvY2Vzcy5lbnYuT1BFTkFJX0FQSV9LRVkpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdPUEVOQUlfQVBJX0tFWSBpcyBub3Qgc2V0Jyk7XG59XG5cbi8vIERlY29kZSBhbmQgcGFyc2UgdGhlIGJhc2U2NC1lbmNvZGVkIEZpcmViYXNlIHNlcnZpY2UgYWNjb3VudCBKU09OXG5jb25zdCBiYXNlNjQgPSBwcm9jZXNzLmVudi5GSVJFQkFTRV9TRVJWSUNFX0FDQ09VTlRfS0VZX0JBU0U2NDtcbmNvbnN0IGpzb25TdHJpbmcgPSBCdWZmZXIuZnJvbShiYXNlNjQsICdiYXNlNjQnKS50b1N0cmluZygndXRmLTgnKTtcbmNvbnN0IHNlcnZpY2VBY2NvdW50ID0gSlNPTi5wYXJzZShqc29uU3RyaW5nKTtcblxuLy8gSW5pdGlhbGl6ZSBGaXJlYmFzZSBBZG1pbiBTREsgaWYgbm90IGFscmVhZHkgaW5pdGlhbGl6ZWRcbmlmICghZ2V0QXBwcygpLmxlbmd0aCkge1xuICBpbml0aWFsaXplQXBwKHtcbiAgICBjcmVkZW50aWFsOiBjZXJ0KHNlcnZpY2VBY2NvdW50KSxcbiAgfSk7XG59XG5cbmNvbnN0IGFkbWluRGIgPSBnZXRGaXJlc3RvcmUoKTtcbmNvbnN0IG9wZW5haSA9IG5ldyBPcGVuQUkoeyBhcGlLZXk6IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZIH0pO1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKFxuICByZXE6IE5leHRBcGlSZXF1ZXN0LFxuICByZXM6IE5leHRBcGlSZXNwb25zZVxuKSB7XG4gIGNvbnN0IHsgcHJvamVjdElkLCB0aHJlYWRJZCB9ID0gcmVxLmJvZHk7XG5cbiAgLy8gVmFsaWRhdGUgcmVxdWVzdCBib2R5XG4gIGlmICh0eXBlb2YgcHJvamVjdElkICE9PSAnc3RyaW5nJyB8fCB0eXBlb2YgdGhyZWFkSWQgIT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIHJlc1xuICAgICAgLnN0YXR1cyg0MDApXG4gICAgICAuanNvbih7IGVycm9yOiAnTWlzc2luZyBvciBpbnZhbGlkIHByb2plY3RJZC90aHJlYWRJZCcgfSk7XG4gIH1cblxuICB0cnkge1xuICAgIC8vIEZldGNoIHByb2plY3QgZGF0YVxuICAgIGNvbnN0IHByb2plY3RSZWYgPSBhZG1pbkRiLmRvYyhgcHJvamVjdHMvJHtwcm9qZWN0SWR9YCk7XG4gICAgY29uc3QgcHJvamVjdFNuYXAgPSBhd2FpdCBwcm9qZWN0UmVmLmdldCgpO1xuICAgIGlmICghcHJvamVjdFNuYXAuZXhpc3RzKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvcjogJ1Byb2plY3Qgbm90IGZvdW5kJyB9KTtcbiAgICB9XG4gICAgY29uc3QgcHJvamVjdERhdGEgPSBwcm9qZWN0U25hcC5kYXRhKCkhO1xuICAgIGNvbnN0IHVzZXJJZCA9IHByb2plY3REYXRhLm93bmVySWQgfHwgbnVsbDtcblxuICAgIC8vIEZldGNoIHRocmVhZCBkYXRhXG4gICAgY29uc3QgdGhyZWFkUmVmID0gYWRtaW5EYi5kb2MoYHRocmVhZHMvJHt0aHJlYWRJZH1gKTtcbiAgICBjb25zdCB0aHJlYWRTbmFwID0gYXdhaXQgdGhyZWFkUmVmLmdldCgpO1xuICAgIGlmICghdGhyZWFkU25hcC5leGlzdHMpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnVGhyZWFkIG5vdCBmb3VuZCcgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgdGhyZWFkRGF0YSA9IHRocmVhZFNuYXAuZGF0YSgpITtcbiAgICBjb25zdCBtZXNzYWdlcyA9IHRocmVhZERhdGEubWVzc2FnZXMgfHwgW107XG5cbiAgICAvLyBDb252ZXJ0IG1lc3NhZ2VzIHRvIE9wZW5BSS1jb21wYXRpYmxlIGNvbnZlcnNhdGlvbiBmb3JtYXRcbiAgICBjb25zdCBhbGxNZXNzYWdlczogQXJyYXk8eyByb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JzsgY29udGVudDogc3RyaW5nIH0+ID1cbiAgICAgIG1lc3NhZ2VzLm1hcCgobTogYW55KSA9PiAoe1xuICAgICAgICByb2xlOiBtLnNlbmRlciA9PT0gJ2FpJyA/ICdhc3Npc3RhbnQnIDogJ3VzZXInLFxuICAgICAgICBjb250ZW50OiBtLmNvbnRlbnQsXG4gICAgICB9KSk7XG5cbiAgICBjb25zdCBjb252ZXJzYXRpb25UZXh0ID0gYWxsTWVzc2FnZXNcbiAgICAgIC5tYXAoKG0pID0+IGAke20ucm9sZSA9PT0gJ2Fzc2lzdGFudCcgPyAnQUk6JyA6ICdVc2VyOid9ICR7bS5jb250ZW50fWApXG4gICAgICAuam9pbignXFxuXFxuJyk7XG5cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBTdGVwIDE6IERldGVybWluZSBSZWxldmFudCBTZWN0aW9uc1xuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIGNvbnN0IHNlY3Rpb25Qcm9tcHQgPSBgXG5CYXNlZCBvbiB0aGUgZm9sbG93aW5nIHByb2plY3QgZGV0YWlscyBhbmQgY29udmVyc2F0aW9uLCBpZGVudGlmeSB0aGUgbW9zdCByZWxldmFudCBzZWN0aW9ucyB0byBpbmNsdWRlIGluIGEgZGV0YWlsZWQgZW5naW5lZXJpbmcgcmVwb3J0LiBGb3IgZWFjaCBzZWN0aW9uLCBwcm92aWRlIGEgc2hvcnQgZGVzY3JpcHRpb24gb2YgaXRzIHB1cnBvc2UgYW5kIHdoYXQgY29udGVudCBpdCBzaG91bGQgaW5jbHVkZS4gRXhjbHVkZSBpcnJlbGV2YW50IHNlY3Rpb25zLlxuXG4qKkdlbmVyYWwgQ2F0ZWdvcmllcyoqOlxuMS4gRW5naW5lZXJpbmcgQ29kZXMgYW5kIFN0YW5kYXJkc1xuMi4gU2FmZXR5IGFuZCBSaXNrIEFzc2Vzc21lbnRcbjMuIEVudmlyb25tZW50YWwgQ29tcGxpYW5jZSBhbmQgUGVybWl0dGluZ1xuNC4gVGVjaG5pY2FsIFByb2Nlc3MgQW5hbHlzaXNcbjUuIFByb2plY3QgTWFuYWdlbWVudCBSZWNvbW1lbmRhdGlvbnNcbjYuIFJlZmVyZW5jZXMgYW5kIENpdGF0aW9ucyAoYWxsIGNvZGVzLCBzdGFuZGFyZHMsIGFuZCByZWd1bGF0aW9ucyBtZW50aW9uZWQpXG43LiBPdGhlciBSZWxldmFudCBUb3BpY3MgKGlmIGFwcGxpY2FibGUpXG5cbioqSW5wdXRzKio6XG4tIFByb2plY3QgRGV0YWlsczogJHtKU09OLnN0cmluZ2lmeShwcm9qZWN0RGF0YSwgbnVsbCwgMil9XG4tIFRocmVhZCBDb252ZXJzYXRpb246XG4ke2NvbnZlcnNhdGlvblRleHR9XG5cbioqT3V0cHV0IEZvcm1hdCoqOlxuUHJvdmlkZSBhIHN0cnVjdHVyZWQgbGlzdCBvZiByZWxldmFudCBzZWN0aW9ucyB3aXRoIGRlc2NyaXB0aW9ucy5cbiAgICBgO1xuXG4gICAgY29uc3Qgc2VjdGlvblJlc3BvbnNlID0gYXdhaXQgb3BlbmFpLmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcbiAgICAgIG1vZGVsOiAnZ3B0LTRvLW1pbmknLFxuICAgICAgbWVzc2FnZXM6IFtcbiAgICAgICAge1xuICAgICAgICAgIHJvbGU6ICdzeXN0ZW0nLFxuICAgICAgICAgIGNvbnRlbnQ6ICdZb3UgYXJlIGEgcHJvZmVzc2lvbmFsIHRlY2huaWNhbCB3cml0ZXIgc3BlY2lhbGl6aW5nIGluIGh5ZHJvZ2VuIGVuZ2luZWVyaW5nIGFuZCBzYWZldHkuJyxcbiAgICAgICAgfSxcbiAgICAgICAgeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHNlY3Rpb25Qcm9tcHQgfSxcbiAgICAgIF0sXG4gICAgICB0ZW1wZXJhdHVyZTogMC4zLFxuICAgICAgdG9wX3A6IDAuODUsXG4gICAgICBmcmVxdWVuY3lfcGVuYWx0eTogMC4yLFxuICAgICAgcHJlc2VuY2VfcGVuYWx0eTogMC4yLFxuICAgICAgbWF4X3Rva2VuczogMjAwMCxcbiAgICB9KTtcblxuICAgIGNvbnN0IHJlbGV2YW50U2VjdGlvbnMgPSBzZWN0aW9uUmVzcG9uc2UuY2hvaWNlc1swXT8ubWVzc2FnZT8uY29udGVudCB8fCAnJztcbiAgICBjb25zb2xlLmxvZygnUmVsZXZhbnQgU2VjdGlvbnM6JywgcmVsZXZhbnRTZWN0aW9ucyk7XG5cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBTdGVwIDI6IERyYWZ0IGEgRGV0YWlsZWQgUmVwb3J0XG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgY29uc3QgZHJhZnRSZXBvcnRQcm9tcHQgPSBgXG5Zb3UgYXJlIGFuIGV4cGVydCB0ZWNobmljYWwgcmVwb3J0IHdyaXRlci4gVXNpbmcgdGhlIHJlbGV2YW50IHNlY3Rpb25zIGlkZW50aWZpZWQgYmVsb3csIGRyYWZ0IGEgZGV0YWlsZWQsIG11bHRpcGFnZSByZXBvcnQuIEVhY2ggc2VjdGlvbiBtdXN0IGJlIGNvbXByZWhlbnNpdmUsIGluY2x1ZGUgYWxsIGtleSBpbmZvcm1hdGlvbiBmcm9tIHRoZSBjb252ZXJzYXRpb24gYW5kIHByb2plY3QgZGV0YWlscywgYW5kIG1haW50YWluIGEgZm9ybWFsIHRvbmUuXG5cbioqUmVsZXZhbnQgU2VjdGlvbnMqKjpcbiR7cmVsZXZhbnRTZWN0aW9uc31cblxuKipQcm9qZWN0IERldGFpbHMqKjogIFxuJHtKU09OLnN0cmluZ2lmeShwcm9qZWN0RGF0YSwgbnVsbCwgMil9XG5cbioqVGhyZWFkIENvbnZlcnNhdGlvbioqOiAgXG4ke2NvbnZlcnNhdGlvblRleHR9XG5cbiMjIyBSZXBvcnQgUmVxdWlyZW1lbnRzOlxuLSBJbmNsdWRlIGFsbCByZWxldmFudCBzZWN0aW9ucyBpZGVudGlmaWVkLlxuLSBQcm92aWRlIGluLWRlcHRoIGFuYWx5c2lzLCBjaXRhdGlvbnMsIGFuZCBhY3Rpb25hYmxlIHJlY29tbWVuZGF0aW9ucy5cbi0gVXNlIHN0cnVjdHVyZWQgZm9ybWF0dGluZzogc2VjdGlvbnMsIGhlYWRlcnMsIGJ1bGxldCBwb2ludHMsIGFuZCB0YWJsZXMgd2hlcmUgYXBwbGljYWJsZS5cbi0gRm9jdXMgb24gdGhvcm91Z2huZXNzIGFuZCBkZXRhaWwuIEVuc3VyZSBubyBpbnNpZ2h0cyBmcm9tIHRoZSBjb252ZXJzYXRpb24gYXJlIG9taXR0ZWQuXG5cbkdlbmVyYXRlIHRoZSBkZXRhaWxlZCByZXBvcnQuXG4gICAgYDtcblxuICAgIGNvbnN0IGRyYWZ0UmVzcG9uc2UgPSBhd2FpdCBvcGVuYWkuY2hhdC5jb21wbGV0aW9ucy5jcmVhdGUoe1xuICAgICAgbW9kZWw6ICdncHQtNG8tbWluaScsXG4gICAgICBtZXNzYWdlczogW1xuICAgICAgICB7XG4gICAgICAgICAgcm9sZTogJ3N5c3RlbScsXG4gICAgICAgICAgY29udGVudDpcbiAgICAgICAgICAgICdZb3UgYXJlIGEgcHJvZmVzc2lvbmFsIHRlY2huaWNhbCB3cml0ZXIgc3BlY2lhbGl6aW5nIGluIGh5ZHJvZ2VuIGVuZ2luZWVyaW5nIHJlcG9ydHMuJyxcbiAgICAgICAgfSxcbiAgICAgICAgeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IGRyYWZ0UmVwb3J0UHJvbXB0IH0sXG4gICAgICBdLFxuICAgICAgdGVtcGVyYXR1cmU6IDAuMixcbiAgICAgIG1heF90b2tlbnM6IDYwMDAsXG4gICAgfSk7XG5cbiAgICBjb25zdCBkcmFmdFJlcG9ydCA9IGRyYWZ0UmVzcG9uc2UuY2hvaWNlc1swXT8ubWVzc2FnZT8uY29udGVudCB8fCAnJztcbiAgICBjb25zb2xlLmxvZygnRHJhZnQgUmVwb3J0OicsIGRyYWZ0UmVwb3J0KTtcblxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFN0ZXAgMzogRXh0cmFjdCBSZWZlcmVuY2VzXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgY29uc3QgcmVmZXJlbmNlc1Byb21wdCA9IGBcbkZyb20gdGhlIGZvbGxvd2luZyBkcmFmdCByZXBvcnQsIGV4dHJhY3QgYW5kIGNvbXBpbGUgYSBjb21wcmVoZW5zaXZlIGxpc3Qgb2YgYWxsIG1lbnRpb25lZCBjb2Rlcywgc3RhbmRhcmRzLCBydWxlcywgcmVndWxhdGlvbnMsIGFuZCBvdGhlciByZWZlcmVuY2VkIGJvZGllcyBvZiB3b3JrLiBFYWNoIGl0ZW0gc2hvdWxkIGluY2x1ZGUgaXRzIGZ1bGwgbmFtZSBhbmQsIGlmIHBvc3NpYmxlLCBhIGJyaWVmIGRlc2NyaXB0aW9uIG9mIGl0cyByZWxldmFuY2UgdG8gdGhlIHByb2plY3QuXG5cbioqRHJhZnQgUmVwb3J0Kio6XG4ke2RyYWZ0UmVwb3J0fVxuXG5Qcm92aWRlIHRoZSBleHRyYWN0ZWQgcmVmZXJlbmNlcyBpbiBhIHN0cnVjdHVyZWQgbGlzdCBmb3JtYXQuXG4gICAgYDtcblxuICAgIGNvbnN0IHJlZmVyZW5jZXNSZXNwb25zZSA9IGF3YWl0IG9wZW5haS5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XG4gICAgICBtb2RlbDogJ2dwdC00by1taW5pJyxcbiAgICAgIG1lc3NhZ2VzOiBbXG4gICAgICAgIHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6ICdZb3UgYXJlIGEgdGVjaG5pY2FsIGRvY3VtZW50YXRpb24gc3BlY2lhbGlzdC4nIH0sXG4gICAgICAgIHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiByZWZlcmVuY2VzUHJvbXB0IH0sXG4gICAgICBdLFxuICAgICAgdGVtcGVyYXR1cmU6IDAuMixcbiAgICAgIG1heF90b2tlbnM6IDIwMDAsXG4gICAgfSk7XG5cbiAgICBjb25zdCByZWZlcmVuY2VzU2VjdGlvbiA9IHJlZmVyZW5jZXNSZXNwb25zZS5jaG9pY2VzWzBdPy5tZXNzYWdlPy5jb250ZW50IHx8ICcnO1xuICAgIGNvbnNvbGUubG9nKCdSZWZlcmVuY2VzIFNlY3Rpb246JywgcmVmZXJlbmNlc1NlY3Rpb24pO1xuXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gU3RlcCA0OiBSZWZpbmUgdGhlIEVudGlyZSBSZXBvcnRcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICBjb25zdCByZWZpbmVQcm9tcHQgPSBgXG5Zb3UgYXJlIGFuIGV4cGVydCBlZGl0b3IuIFJlZmluZSB0aGUgZHJhZnQgcmVwb3J0IGJlbG93IHRvIGVuc3VyZSBpdCBpcyBwb2xpc2hlZCwgdGhvcm91Z2gsIGFuZCBwcm9mZXNzaW9uYWwuIEV4cGFuZCBhbnkgdW5kZXJkZXZlbG9wZWQgc2VjdGlvbnMsIGFuZCBpbnRlZ3JhdGUgdGhlIHJlZmVyZW5jZXMgc2VjdGlvbiBhcyBhIGZvcm1hbCBwYXJ0IG9mIHRoZSByZXBvcnQuXG5cbioqRHJhZnQgUmVwb3J0Kio6XG4ke2RyYWZ0UmVwb3J0fVxuXG4qKlJlZmVyZW5jZXMgU2VjdGlvbioqOlxuJHtyZWZlcmVuY2VzU2VjdGlvbn1cblxuUmVmaW5lIGFuZCBlbmhhbmNlIHRoZSByZXBvcnQsIGVuc3VyaW5nIGFsbCBpbnNpZ2h0cyBhbmQgcmVmZXJlbmNlcyBhcmUgaW5jbHVkZWQuXG4gICAgYDtcblxuICAgIGNvbnN0IHJlZmluZVJlc3BvbnNlID0gYXdhaXQgb3BlbmFpLmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcbiAgICAgIG1vZGVsOiAnZ3B0LTRvLW1pbmknLFxuICAgICAgbWVzc2FnZXM6IFtcbiAgICAgICAgeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogJ1lvdSBhcmUgYSBwcm9mZXNzaW9uYWwgZWRpdG9yLicgfSxcbiAgICAgICAgeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHJlZmluZVByb21wdCB9LFxuICAgICAgXSxcbiAgICAgIHRlbXBlcmF0dXJlOiAwLjIsXG4gICAgICBtYXhfdG9rZW5zOiA2MDAwLFxuICAgIH0pO1xuXG4gICAgY29uc3QgZmluYWxSZXBvcnRDb250ZW50ID0gcmVmaW5lUmVzcG9uc2UuY2hvaWNlc1swXT8ubWVzc2FnZT8uY29udGVudCB8fCAnJztcblxuICAgIC8vIFNhdmUgdGhlIGZpbmFsIHJlcG9ydCB0byBGaXJlc3RvcmVcbiAgICBjb25zdCByZXBvcnRSZWYgPSBhZG1pbkRiLmNvbGxlY3Rpb24oJ3JlcG9ydHMnKS5kb2MoKTtcbiAgICBhd2FpdCByZXBvcnRSZWYuc2V0KHtcbiAgICAgIHByb2plY3RJZCxcbiAgICAgIHVzZXJJZCxcbiAgICAgIHRpdGxlOiBgRW5naW5lZXJpbmcgUmVwb3J0IC0gJHtwcm9qZWN0RGF0YT8ucHJvamVjdE5hbWUgfHwgJ1Byb2plY3QnfWAsXG4gICAgICBjb250ZW50OiBmaW5hbFJlcG9ydENvbnRlbnQsXG4gICAgICB0eXBlOiAncHJvamVjdCcsXG4gICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgfSk7XG5cbiAgICByZXR1cm4gcmVzXG4gICAgICAuc3RhdHVzKDIwMClcbiAgICAgIC5qc29uKHsgbWVzc2FnZTogJ1JlcG9ydCBnZW5lcmF0ZWQnLCBjb250ZW50OiBmaW5hbFJlcG9ydENvbnRlbnQgfSk7XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZW5lcmF0aW5nIHJlcG9ydDonLCBlcnJvcik7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSk7XG4gIH1cbn0iXSwibmFtZXMiOlsiZ2V0QXBwcyIsImluaXRpYWxpemVBcHAiLCJjZXJ0IiwiZ2V0RmlyZXN0b3JlIiwiT3BlbkFJIiwicHJvY2VzcyIsImVudiIsIkZJUkVCQVNFX1NFUlZJQ0VfQUNDT1VOVF9LRVlfQkFTRTY0IiwiRXJyb3IiLCJPUEVOQUlfQVBJX0tFWSIsImJhc2U2NCIsImpzb25TdHJpbmciLCJCdWZmZXIiLCJmcm9tIiwidG9TdHJpbmciLCJzZXJ2aWNlQWNjb3VudCIsIkpTT04iLCJwYXJzZSIsImxlbmd0aCIsImNyZWRlbnRpYWwiLCJhZG1pbkRiIiwib3BlbmFpIiwiYXBpS2V5IiwiaGFuZGxlciIsInJlcSIsInJlcyIsInByb2plY3RJZCIsInRocmVhZElkIiwiYm9keSIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsInByb2plY3RSZWYiLCJkb2MiLCJwcm9qZWN0U25hcCIsImdldCIsImV4aXN0cyIsInByb2plY3REYXRhIiwiZGF0YSIsInVzZXJJZCIsIm93bmVySWQiLCJ0aHJlYWRSZWYiLCJ0aHJlYWRTbmFwIiwidGhyZWFkRGF0YSIsIm1lc3NhZ2VzIiwiYWxsTWVzc2FnZXMiLCJtYXAiLCJtIiwicm9sZSIsInNlbmRlciIsImNvbnRlbnQiLCJjb252ZXJzYXRpb25UZXh0Iiwiam9pbiIsInNlY3Rpb25Qcm9tcHQiLCJzdHJpbmdpZnkiLCJzZWN0aW9uUmVzcG9uc2UiLCJjaGF0IiwiY29tcGxldGlvbnMiLCJjcmVhdGUiLCJtb2RlbCIsInRlbXBlcmF0dXJlIiwidG9wX3AiLCJmcmVxdWVuY3lfcGVuYWx0eSIsInByZXNlbmNlX3BlbmFsdHkiLCJtYXhfdG9rZW5zIiwicmVsZXZhbnRTZWN0aW9ucyIsImNob2ljZXMiLCJtZXNzYWdlIiwiY29uc29sZSIsImxvZyIsImRyYWZ0UmVwb3J0UHJvbXB0IiwiZHJhZnRSZXNwb25zZSIsImRyYWZ0UmVwb3J0IiwicmVmZXJlbmNlc1Byb21wdCIsInJlZmVyZW5jZXNSZXNwb25zZSIsInJlZmVyZW5jZXNTZWN0aW9uIiwicmVmaW5lUHJvbXB0IiwicmVmaW5lUmVzcG9uc2UiLCJmaW5hbFJlcG9ydENvbnRlbnQiLCJyZXBvcnRSZWYiLCJjb2xsZWN0aW9uIiwic2V0IiwidGl0bGUiLCJwcm9qZWN0TmFtZSIsInR5cGUiLCJjcmVhdGVkQXQiLCJEYXRlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/reports/multistep-generate.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Freports%2Fmultistep-generate&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Freports%2Fmultistep-generate.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();